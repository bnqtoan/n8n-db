# Qualys Vulnerability Trigger Scan Workflow

## Use cases:
- **Automated Vulnerability Scanning:** Trigger a Qualys vulnerability scan directly from Slack, streamlining the process of identifying and addressing security issues in your infrastructure.
- **Continuous Monitoring:** Automatically check the status of Qualys scans and receive notifications in Slack when they are completed, ensuring timely updates on your system's security posture.
- **Security Incident Response:** Quickly initiate vulnerability scans in response to security incidents, enabling rapid assessment of potential impact and facilitating remediation efforts.

## How it works:
1. **Triggered by Slack:** The workflow is initiated via a Slack shortcut, which opens a modal to collect necessary scan parameters (asset groups, scan title, option title).
2. **Initiates Qualys Scan:** The provided parameters are then passed to the Qualys API to start a vulnerability scan using the "Start VM Scan in Qualys" node, sending a POST request to the Qualys API endpoint with the specified parameters.
3. **XML to JSON Conversion:** The response from Qualys, which is in XML format, is converted to JSON using the "Convert XML to JSON" node for easier data manipulation.
4. **Confirmation Message in Slack:** An update will be sent in the same Slack channel.
5. **Scan Status Loop:** The workflow enters a loop ("Loop Over Items" and "Wait 5 Min" nodes) that periodically checks the status of the scan via the Qualys API ("Fetch Scan Results"). It retrieves the status by sending another GET request to Qualys API using `scan_reference` obtained earlier. The XML response is again converted to JSON ("Convert XML to JSON1").
6. **Completion Check:** The "Check if Scan Finished" node verifies if the scan status is "FINISHED".
7. **Slack Notification with Summary:** Once the scan is complete, a detailed summary of the scan results, including detected vulnerabilities and a link to the full report in Qualys, is posted to the designated Slack channel. The original confirmation message in the Slack channel is deleted to avoid clutter.

## Services:
- Qualys API
- Slack API

## Hashtags:
#n8n #automation #Qualys #vulnerabilityscanning #Slack
